<!DOCTYPE html>
<!-- saved from url=(0066)http://dmolinarius.github.io/demofiles/elc-d3/cours3/example1.html -->
<html lang="fr">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <title>Media Player</title>
    <link rel="stylesheet" type="text/css" href="/stylesheets/style.css" />
</head>


    <body >

        <header>
            zjefbhezfbh
        </header>

        
        <div id="allPage"> 
            <div class = "bandeau">
                ouiiiiiiiiiiii
            </div>
            <div class = "mainPage">
                <div class="frontMusic">
                    <div class="canva">
                        <div class="imageFront">
                            <img src="images/SawanoCover.jpg" id="albumCover"/>
                        </div>
                        <div class="texteFront">
                            <h3>Titre</h3>
                            
                            <h1 onclick="modif()">Remember</h1></a>
                            
                            <h3 id="infos">Sawano Hiroyuki, 2012</h3>
                        </div>
                    </div>
                </div>
                <div class="folders" id="folders">
                </div>

            </div>

        </div>

        
    </body>


    <script>
        display_artist();

        
        function modif(){
            location.href="http://localhost:3000/listen"
            console.log("oueiuzfeziuhf")
        }

        function display_artist(){
            const liste_artiste="<%= liste %>".split(",");
            /* console.log(liste_artiste); */
            const folders_div = document.getElementById("folders");
            const n=liste_artiste.length;
            for (let i=0;i<n;i++){
                let div_artiste = document.createElement("div");
                document.createAttribute("class");
                /* let text_artiste = document.createTextNode(liste_artiste[i]); */
                div_artiste.innerHTML = liste_artiste[i];
                /* div_artiste.appendChild(text_artiste); */
                div_artiste.id = "div_artiste_"+i ;
                div_artiste.className = "div_artiste";
                cmdfunction="display_album('" + div_artiste.id + "');"
                div_artiste.setAttribute("alreadyclicked","false");
                div_artiste.setAttribute("onclick",cmdfunction);
                folders_div.appendChild(div_artiste);
            }
        }

        function display_album(artistid){
            div_artiste=document.getElementById(artistid);
            booleen= div_artiste.getAttribute("alreadyclicked");
            if (booleen=="false"){
                artiste_name=div_artiste.innerHTML;
                div_artiste.setAttribute("alreadyclicked", "true");
                liste_albums=JSON.parse(httpGet("http://localhost:3000/get/artist/"+artiste_name)).liste_albums;
                const n=liste_albums.length;
                for (let i=0;i<n;i++){
                    let div_album = document.createElement("div");
                    div_album.innerHTML = liste_albums[i];
                    div_album.id = "div_album_"+i+"_"+artistid;
                    div_album.className = "div_album";
                    div_album.setAttribute("artist",artiste_name);
                    div_album.setAttribute("alreadyclicked","false");
                    cmdfunction="display_songs('" + div_album.id + "');"
                    div_artiste.setAttribute("onclick",cmdfunction);
                    div_artiste.appendChild(div_album);
                }
            }
            else{
                while (div_artiste.childNodes.length>1) {
                    div_artiste.lastChild.remove();
                }
                div_artiste.setAttribute("alreadyclicked", "false");

            }
            
        }

        function display_songs(albumid){
            div_album=document.getElementById(albumid);
            booleen= div_album.getAttribute("alreadyclicked");
            if (booleen=="false"){
                album_name=div_album.innerHTML;
                div_album.setAttribute("alreadyclicked", "true");
                liste_songs=JSON.parse(httpGet("http://localhost:3000/get/album/"+artiste_name+"/"+album_name)).liste_songs;
                const n=liste_songs.length;
                for (let i=0;i<n;i++){
                    let div_song = document.createElement("div"); /*Ou audio Ã  voir avec le GOAT du CSS*/
                    /* let text_artiste = document.createTextNode(liste_artiste[i]); */
                    div_song.innerHTML = liste_songs[i];
                    /* div_artiste.appendChild(text_artiste); */
                    div_song.id = "div_song_"+i+"_"+albumid;
                    div_song.className = "div_song";
                    /* cmdfunction="display_album('" + div_artiste.id + "');"
                    div_artiste.setAttribute("onclick",cmdfunction); */
                    div_album.appendChild(div_song);
                }
            }
            else{
                while (div_album.childNodes.length>1) {
                    div_album.lastChild.remove();
                }
                div_album.setAttribute("alreadyclicked", "false");

            }
            
        }

        function httpGet(theUrl) {
        let xmlHttpReq = new XMLHttpRequest();
        xmlHttpReq.open("GET", theUrl, false);
        xmlHttpReq.send(null);
        return xmlHttpReq.responseText;
        }
      

        

    </script>
</html>